package com.comverse.upm.UpmBct;

/**
 * 
 * @author osmolya
 */

import com.comverse.upm.common.*;
import com.comverse.upm.upmPages.ProcessPage;

import com.thoughtworks.selenium.*;
import org.junit.After;
// import org.junit.Before;
import org.junit.Test;


public class UpmRunScom {
	public Selenium selenium;
/*	@Before
	public void setUp() throws Exception {
		UpmPrep UP = new UpmPrep();
		selenium=UP.startSeleniumAndOpenUpmHome(selenium);
	}
	*/
private UpmPrep Prep = new UpmPrep();
private String templateName = "Auto_SCOM";
private Boolean templateExists;
private String moduleName = "SCOM";
private String nodeType = "manager";
private String serverId = "ORP";
private String workflowType="CBS Batch Process";
private int DefaultStateCheckIterations=20;
	
	@Test
	public void test_upm_bct_scom_workflow() throws Exception {
		
		selenium=Prep.startSeleniumAndOpenUpmHome(selenium);
		
		UpmUtils Utils = new UpmUtils(selenium);
		UpmNavigation Navigate = new UpmNavigation(selenium);
		UpmValidation Validate = new UpmValidation(selenium);
		ProcessPage processPage = new ProcessPage(selenium);
		
		//Check whether login screen is present and log in if required
		Utils.UpmCheckWhetherLoggedInAndLogIn();	
		
		//Go to Process-> Workflow tab	
		Navigate.goToProcessWorkflow();
		processPage.selectTemplateWorkflowType(workflowType);
		
		//Check whether Auto_SCOM template exists; if not create by invoking createJnlTemplate class		
		templateExists=Utils.checkTemplate(templateName);
		
		//Proceed to create new template only if it does not already exist
		if (!(templateExists))
		{
			Utils.upm_create_template(templateName,moduleName,nodeType,serverId);
		}
		//Run template
				Utils.runTemplate(templateName);

		//Go to History tab and click Refresh until last created workflow is Completed
		//If does not complete within 20 iterations, test will fail		
				Validate.validateLastWorkflowCompleted(DefaultStateCheckIterations);
	}
	
	@After
	public void tearDown() throws Exception {
		selenium.stop();
	}
}


