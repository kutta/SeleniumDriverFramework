/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

package com.comverse.sfa.common;

import java.io.IOException;
import java.io.InputStream;
import java.util.Properties;
import java.util.MissingResourceException;
import com.comverse.css.common.Wait;
import com.comverse.css.common.PropertyHelper;
import com.thoughtworks.selenium.DefaultSelenium;

/**
 *
 * @author bgh20100
 */
public class startsfa {

    PropertyHelper propsHelper = new PropertyHelper();
    public DefaultSelenium SfaSelenium;
    public Wait waitingsfa;
    public static final String PROPERTY_FILE = "Passwords.properties";

    public void loginAndLaunchSFA() throws Exception {
        
        String host = "localhost";
        String browser = "*iexplore";
        String url = propsHelper.getInitProperties("sfa_url");
        int portInt = 4444;

        SfaSelenium = new DefaultSelenium(host, portInt, browser, url);
        SfaSelenium.start();
        waitingsfa = new Wait(SfaSelenium);
        SfaSelenium.open("ssa/app/sales.ctrl?");
        SfaSelenium.windowMaximize();
        waitingsfa.forElementPresent("Iujgbo2");

        Properties props = readProperties(PROPERTY_FILE);

        String login = props.getProperty("LOGIN.CASEUIUser");
        String password = props.getProperty("PASSWD.CASEUIUser");

        // Verify properties
        if (login == null || login.length() == 0) {
            throw new MissingResourceException("Missing property LOGIN.CASEUIUser", PROPERTY_FILE, "LOGIN.CASEUIUser");
        }
        if (password == null || password.length() == 0) {
            throw new MissingResourceException("Missing property PASSWD.CASEUIUser", PROPERTY_FILE, "PASSWD.CASEUIUser");
        }

        // User login for CASE UI and CSS
       SfaSelenium.type("Iujgbo2", login);
       SfaSelenium.type("I604i25", password);
       SfaSelenium.click("$dv71go");
      
    }

    public void logoutAndStop() throws Exception {
        
        waitingsfa = new Wait(SfaSelenium);
        waitingsfa.forElementPresent("//div[@id='Am12pov']");
        SfaSelenium.click("//div[@id='Am12pov']");
        waitingsfa.forElementPresent("Iujgbo2");

        //stop the instance
        SfaSelenium.stop();
    }

     /**
     *
     * @param name
     * @return
     * @throws IOException
     */
    public static Properties readProperties(String name) throws IOException {
        Properties properties = new Properties();
        ClassLoader loader1 = startsfa.class.getClassLoader();
        InputStream inStream = loader1.getResourceAsStream(name);
        properties.load(inStream);
        return properties;
    }

}
